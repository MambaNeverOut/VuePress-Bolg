---
title: "浏览器渲染原理"
sidebarDepth: 2
---

# 浏览器渲染原理

1.  根据 HTML 构建 HTML 树（DOM）
2.  根据 CSS 构建 CSS 树（CSSOM）
3.  将两棵树合并成一颗渲染树（render tree)
4.  Layout 布局 （文档流、盒模型、计算大小和位置）
5.  Paint 绘制（把边框颜色、文字颜色、阴影等画出来）
6.  Composite 合成（根据层叠关系展示画面）

## 回流（Reflow）重新计算元素的集合尺寸，位置

## 重绘（Repaint）绘制页面发生变化的部分

## 浏览器知识

- 功能模块：用户界面、渲染引擎、JS 引擎、存储等
- 功能模块一般各自处于不同的线程

## JS 引擎（v8 引擎，C++编写）

- 功能
  - 编译：把 JS 代码翻译为及其能执行的字节码或者及机器码
  - 优化：改写代码，使其高效
  - 执行：执行上面的字节码或者机器码
  - 垃圾回收：把 JS 用完的内存回收，方便之后再次使用

## JS 引擎如何渲染界面

- 通过调用跨线程通信（chrome 提供的 api）来实现的
  > GUI 渲染线程和 JS 引擎线程互相排斥

## 执行

- 提供 API: window/document/setTimeout，这些都是浏览器的功能，而不是 js 的功能
- 将这些功能称为运行环境 runtime env
- JS 代码存放在内存中，在内存中运行
